(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{68082:function(e,n,t){"use strict";var r;t.d(n,{G:function(){return r}}),function(e){e.FAVORITES="favorites",e.GROUPS="groups",e.USERS="users",e.USERS_GEOLOCATION="usersGeolocation",e.CHATS="chats"}(r||(r={}))},27717:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return se}});var r,i,o=t(11163),s=t(67294),c=t(84644),l=t(59499),a=t(87357),u=t(87952),d=t(15861),f=t(30381),h=t.n(f),p=t(71383),m=t(8797),v=(0,m.ZP)(a.Z)(r||(r=(0,p.Z)(["\n  overflow-y: auto;\n\n  &::-webkit-scrollbar {\n    display: none;\n  }\n"]))),x=(0,m.ZP)(a.Z)(i||(i=(0,p.Z)(["\n  position: relative;\n  margin-left: 10px;\n\n  &:before {\n    content: '';\n    position: absolute;\n    bottom: 20px;\n    left: ",";\n    right: ",";\n    z-index: 1;\n    border: solid 6px transparent;\n    border-left-color: ",";\n    border-right-color: ",";\n  }\n"])),(function(e){return e.isCurrentUser?"":"-12px"}),(function(e){return e.isCurrentUser?"-12px":""}),(function(e){return e.isCurrentUser?"lightgreen":""}),(function(e){return e.isCurrentUser?"":"lightgray"})),j=t(35294),g=t(18972),b=t(57976),y=t(85893),Z=function(e){var n=e.anchorEl,t=e.onCloseMenu,r=e.id,i=e.onRemoveItem,o=e.onClickMenu,s=Boolean(n);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(b.Z,{sx:{color:"black",cursor:"pointer"},onClick:function(e){return o(e)}}),(0,y.jsx)(j.Z,{anchorEl:n,open:s,onClose:t,children:(0,y.jsx)(g.Z,{onClick:function(){return i(r)},children:"Remove"})})]})},O=function(e){var n=e.item,t=e.isCurrentUser,r=e.avatar,i=e.onClickMenu,o=e.anchorEl,s=e.onCloseMenu,c=e.onRemoveMessage,l=new URL("https://firebasestorage.googleapis.com"),u=h().unix(n.timestamp).format("kk:mm");return(0,y.jsxs)(x,{display:"flex",alignItems:"center",bgcolor:t?"lightgreen":"lightgray",p:1,mb:.5,sx:{borderRadius:2,wordBreak:"break-all"},width:"fit-content",isCurrentUser:t,children:[!t&&r,(0,y.jsxs)(a.Z,{display:"flex",flexDirection:"column",alignItems:t?"end":"",sx:{ml:t?0:1,mr:t?1:0},children:[n.content.includes(l.host)?(0,y.jsx)(a.Z,{display:"flex",height:"100px",width:1,children:(0,y.jsx)("img",{alt:n.content,src:n.content})}):(0,y.jsx)(d.Z,{color:"black",children:n.content}),(0,y.jsx)(d.Z,{sx:{fontSize:10},color:"black",children:u})]}),t&&(0,y.jsxs)(y.Fragment,{children:[r,(0,y.jsx)(Z,{anchorEl:o,onCloseMenu:s,onRemoveItem:c,id:n.messageId,onClickMenu:i})]})]})},C=t(16835),w=t(87663),P=t(92114);function E(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function k(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?E(Object(t),!0).forEach((function(n){(0,l.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):E(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var S=function(e,n){var t=(0,s.useState)({loadingChats:!1,chats:[],id:null}),r=t[0],i=t[1];return(0,s.useEffect)((function(){i((function(e){return k(k({},e),{},{loadingChats:!0})})),(0,w.jM)((0,w.iH)(P.UO,"chats"),(function(t){var r,o,s=null===(r=t.val())||void 0===r?void 0:r[n],c=null===(o=t.val())||void 0===o?void 0:o[e];if(s){var l=s[e];if(l){var a,u=null===(a=Object.entries(l))||void 0===a?void 0:a.map((function(e){var n=(0,C.Z)(e,2);return k({messageId:n[0]},n[1])}));i({loadingChats:!1,chats:u,id:n})}else i({loadingChats:!1,chats:[],id:null})}else if(c){var d=c[n];if(d){var f,h=null===(f=Object.entries(d))||void 0===f?void 0:f.map((function(e){var n=(0,C.Z)(e,2);return k({messageId:n[0]},n[1])}));i({loadingChats:!1,chats:h,id:e})}else i({loadingChats:!1,chats:[],id:null})}})),i((function(e){return k(k({},e),{},{loadingChats:!1})}))}),[e,n]),r},U=t(66001),T=t(72132),I=t(68082),D=function(e,n,t,r){return r===e?(0,w.VF)((0,w.iH)(P.UO,"".concat(I.G.CHATS,"/").concat(e,"/").concat(n)),t):(0,w.VF)((0,w.iH)(P.UO,"".concat(I.G.CHATS,"/").concat(n,"/").concat(e)),t)},R=t(87305),M=t(76335),N=t(70315),_=t(85773),A=t(11057),F=(t(87898),t(35829)),V=function(e){var n=e.onSelect;return(0,y.jsx)(F.cW,{title:"Pick your emoji\u2026",emoji:"point_up",native:!0,onSelect:n,theme:"dark",style:{position:"absolute",bottom:110,right:90,zIndex:1}})},H=t(59547),L=t(26307),G=t(74231),B=G.Ry({content:G.Z_().min(1,"Content should be of minimum 1 characters length").required("Content is required")}),W=t(82580),q=t(74900),K=t(71153),z=t(98456);function X(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?X(Object(t),!0).forEach((function(n){(0,l.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):X(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var $=function(e){return(0,y.jsxs)(a.Z,{sx:{position:"relative",display:"inline-flex"},children:[(0,y.jsx)(z.Z,Y({variant:"determinate",size:56},e)),(0,y.jsx)(a.Z,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,y.jsx)(d.Z,{variant:"caption",component:"div",color:"text.secondary",children:"".concat(Math.round(e.value),"%")})})]})},J=t(53592),Q=function(e){var n=e.id,t=e.userId,r=e.selectedUserId,i=(0,s.useRef)(null),o=(0,s.useRef)(null),c=(0,W.TA)({initialValues:{content:"",showEmojiModal:!1,imageUrl:null,uploadingProgress:0},validationSchema:B,onSubmit:function(e){var n=e.content;return l(n)}});(0,s.useEffect)((function(){var e=function(e){var n;e.target instanceof HTMLElement&&(null===(n=o.current)||void 0===n||!n.contains(e.target))&&c.setFieldValue("showEmojiModal",!1)};return document.addEventListener("mousedown",e),function(){return document.removeEventListener("mousedown",e)}}));var l=function(e){c.resetForm(),c.values.imageUrl?D(r,t,{content:c.values.imageUrl,timestamp:h()().unix(),uid:t},n).catch((function(e){return T.Am.error(e)})):D(r,t,{content:e,timestamp:h()().unix(),uid:t},n).catch((function(e){return T.Am.error(e)}))};return(0,y.jsx)("form",{onSubmit:c.handleSubmit,children:(0,y.jsxs)(a.Z,{display:"flex",alignItems:"center",children:[c.values.imageUrl?(0,y.jsx)(a.Z,{mx:1,display:"flex",height:"100px",width:1,children:(0,y.jsxs)(a.Z,{display:"flex",position:"relative",children:[(0,y.jsx)("img",{alt:c.values.imageUrl,src:c.values.imageUrl}),(0,y.jsx)(J.Z,{onClick:function(){c.setFieldValue("imageUrl",null),c.setFieldValue("content","")},color:"error",sx:{position:"absolute",right:"-10px",top:"-10px",cursor:"pointer"}})]})}):(0,y.jsx)(_.Z,{placeholder:"Click here to type something...",onChange:c.handleChange,fullWidth:!0,name:"content",multiline:!0,maxRows:5,value:c.values.content,error:c.touched.content&&Boolean(c.errors.content),helperText:c.touched.content&&c.errors.content,onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),c.handleSubmit())},InputProps:{endAdornment:(0,y.jsx)(H.Z,{sx:{color:"white",cursor:"pointer"},onClick:function(){return c.setFieldValue("showEmojiModal",!c.values.showEmojiModal)}})}}),c.values.showEmojiModal&&(0,y.jsx)(a.Z,{ref:o,children:(0,y.jsx)(V,{onSelect:function(e){return c.setFieldValue("content",c.values.content+=e.native)}})}),100===c.values.uploadingProgress||0===c.values.uploadingProgress?(0,y.jsx)(A.Z,{sx:{ml:1,height:"56px"},children:(0,y.jsx)(q.Z,{onClick:function(){i.current&&i.current.click()},sx:{color:"white"}})}):(0,y.jsx)($,{value:c.values.uploadingProgress}),(0,y.jsx)("input",{accept:"image/*",ref:i,type:"file",onChange:function(e){var n;return function(e){if(!e)return null;var n=(0,K.iH)(P.P_,"/files/".concat(e.name)),t=(0,K.B0)(n,e);t.on("state_changed",(function(e){var n=Math.round(e.bytesTransferred/e.totalBytes*100);c.setFieldValue("uploadingProgress",n)}),(function(e){return T.Am.error(e)}),(function(){(0,K.Jt)(t.snapshot.ref).then((function(e){return c.setFieldValue("imageUrl",e),c.setFieldValue("content",e),e}))}))}(null===(n=e.target.files)||void 0===n?void 0:n[0])},style:{display:"none"}}),(0,y.jsx)(A.Z,{type:"submit",disabled:!(c.isValid&&c.dirty),variant:"outlined",sx:{ml:1,height:"56px"},children:(0,y.jsx)(L.Z,{sx:{color:"white"}})})]})})},ee=t(60350),ne=t(18459);function te(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function re(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?te(Object(t),!0).forEach((function(n){(0,l.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):te(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ie=function(e){var n=e.selectedUser,t=(0,s.useState)(null),r=t[0],i=t[1],o=(0,s.useRef)(null),c=(0,ee.Z)().screenType,l=(0,U.a)().user,d=S(null===n||void 0===n?void 0:n.uid,null===l||void 0===l?void 0:l.uid),f=d.chats,h=d.loadingChats,p=d.id;(0,s.useEffect)((function(){var e;null===(e=o.current)||void 0===e||e.scrollIntoView()}),[f]);var m=function(e){f[0].messageId!==e?function(e,n,t,r){return t===e?(0,w.Od)((0,w.iH)(P.UO,"".concat(I.G.CHATS,"/").concat(e,"/").concat(n,"/").concat(r))):(0,w.Od)((0,w.iH)(P.UO,"".concat(I.G.CHATS,"/").concat(n,"/").concat(e,"/").concat(r)))}(null===n||void 0===n?void 0:n.uid,null===l||void 0===l?void 0:l.uid,p,e).catch((function(e){return T.Am.error(e)})):T.Am.error("You can't remove the last message.")};return h?(0,y.jsx)(R.Z,{}):(0,y.jsxs)(a.Z,{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",children:[f.length?(0,y.jsx)(v,{position:"relative",height:c!==ne.TW.MOBILE?550:300,mb:1,children:(0,y.jsxs)(a.Z,{position:"absolute",width:"99%",children:[f.map((function(e){var t=e.uid===(null===l||void 0===l?void 0:l.uid),o=t?null===l||void 0===l?void 0:l.displayName:null===n||void 0===n?void 0:n.displayName;return(0,y.jsx)(a.Z,{display:"flex",flexDirection:"column",justifyContent:t?"end":"start",alignItems:t?"end":"",children:(0,y.jsx)(O,{item:e,isCurrentUser:t,avatar:(0,y.jsx)(u.Z,re({src:t?null===l||void 0===l?void 0:l.photoURL:null===n||void 0===n?void 0:n.photoURL,alt:o},(0,N.GZ)(o))),onClickMenu:function(e){return i(e.currentTarget)},anchorEl:r,onCloseMenu:function(){return i(null)},onRemoveMessage:m})},e.timestamp)})),(0,y.jsx)("div",{ref:o})]})}):(0,y.jsx)(M.Z,{title:"There have been no messages yet..."}),(0,y.jsx)(Q,{id:p,selectedUserId:null===n||void 0===n?void 0:n.uid,userId:null===l||void 0===l?void 0:l.uid})]})},oe=t(43936),se=function(){var e=(0,s.useState)(),n=e[0],t=e[1],r=(0,oe.Z)(),i=(0,o.useRouter)().query.id;return(0,s.useEffect)((function(){var e=r.find((function(e){return e.uid===i}));t(e)}),[i,r]),r?(0,y.jsx)(c.default,{children:(0,y.jsx)(ie,{selectedUser:n})}):(0,y.jsx)(R.Z,{})}},84644:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return C}});var r=t(86886),i=t(55113),o=t(67294),s=t(37917),c=t(6489),l=t(87305),a=t(49274),u=t(74447),d=t(66001),f=t(43936),h=t(76335),p=t(11163),m=t(85773),v=t(87109),x=t(93946),j=t(42761),g=t(85893),b=function(e){var n=e.onChangeSearchTerm,t=e.searchTerm;return(0,g.jsx)(m.Z,{fullWidth:!0,label:"Search...",onKeyDown:function(e){"Escape"===e.key&&(e.preventDefault(),n(""))},value:t,onChange:function(e){return n(e.target.value)},autoComplete:"off",InputProps:{endAdornment:(0,g.jsx)(v.Z,{position:"end",children:(0,g.jsx)(x.Z,{children:(0,g.jsx)(j.Z,{})})})}})},y=t(9798),Z=t(60350),O=t(18459),C=function(e){var n=e.children,t=(0,o.useState)(""),m=t[0],v=t[1],x=(0,d.a)().user,j=(0,f.Z)(),C=(0,p.useRouter)(),w=(0,Z.Z)().screenType;if(!j||!x)return(0,g.jsx)(l.Z,{});var P=j.filter((function(e){return x.uid!==e.uid})).sort((function(e,n){return e.displayName<n.displayName?-1:n.displayName>e.displayName?1:0})).filter((function(e){return!!e.displayName&&e.displayName.toLowerCase().includes(m.toLowerCase())})),E=function(e){return C.push("/chats/".concat(e.uid))};return(0,g.jsxs)(u.Z,{children:[(0,g.jsx)(c.Z,{breadcrumbText:"Chats"}),(0,g.jsx)(a.Z,{title:"Chats"}),(0,g.jsxs)(r.ZP,{container:!0,sx:{mt:2,height:"75vh"},spacing:2,children:[(0,g.jsxs)(r.ZP,{item:!0,xs:12,sm:4,md:3,children:[(0,g.jsx)(b,{searchTerm:m,onChangeSearchTerm:function(e){return v(e)}}),(0,g.jsx)(i.Z,{sx:{py:2,pl:2,height:w===O.TW.DESKTOP?1:"unset"},children:w===O.TW.DESKTOP?(0,g.jsx)(s.t,{users:P,onUserClick:E}):(0,g.jsx)(y.Z,{users:P,onUserClick:E})})]}),(0,g.jsx)(r.ZP,{item:!0,xs:12,sm:8,md:9,children:null!==n&&void 0!==n?n:(0,g.jsx)(h.Z,{title:"No selected chat..."})})]})]})}},76335:function(e,n,t){"use strict";var r=t(87357),i=t(15861),o=t(85893);n.Z=function(e){var n=e.title;return(0,o.jsx)(r.Z,{display:"flex",justifyContent:"center",width:1,children:(0,o.jsx)(i.Z,{variant:"h5",color:"white",children:n})})}},37917:function(e,n,t){"use strict";t.d(n,{t:function(){return Z}});var r=t(59499),i=t(97212),o=t(18987),s=t(87952),c=t(59334),l=t(15861),a=t(67720),u=t(78462),d=t(88078),f=t(85893),h=function(e){for(var n=e.count,t=[],r=0;r<n;r++)t.push(r);return(0,f.jsx)(u.Z,{sx:{width:240},children:t.map((function(e){return(0,f.jsxs)(i.ZP,{alignItems:"flex-start",children:[(0,f.jsx)(o.Z,{children:(0,f.jsx)(d.Z,{variant:"circular",width:40,height:40})}),(0,f.jsx)(c.Z,{primary:(0,f.jsx)(d.Z,{variant:"text"}),secondary:(0,f.jsx)(l.Z,{component:"span",variant:"body2",children:(0,f.jsx)(d.Z,{variant:"text"})})})]},e)}))})},p=t(47036),m=t(13486),v=t(82763),x=t(70315),j=t(66001),g=t(77058);function b(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?b(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Z=function(e){var n=e.users,t=e.onUserClick,r=e.starIcon,u=(0,j.a)().user,d=(0,g.$)().t;if(!n.length)return(0,f.jsx)(h,{count:6});var b=n[n.length-1].uid;return(0,f.jsx)(v.CK,{sx:{mr:2,mb:2,bgcolor:"background.paper"},children:n.map((function(e){var n=e.uid===(null===u||void 0===u?void 0:u.uid);return(0,f.jsxs)(v.xu,{onClick:function(){return t(e)},sx:{cursor:"pointer"},children:[(0,f.jsxs)(i.ZP,{alignItems:"center",children:[e.displayName&&e.photoURL&&(0,f.jsx)(o.Z,{children:(0,f.jsx)(s.Z,y({alt:e.displayName,src:e.photoURL},(0,x.GZ)(e.displayName)))}),(0,f.jsx)(c.Z,{sx:{color:p.Z[300]},primary:(0,f.jsxs)(f.Fragment,{children:[e.displayName,(0,f.jsx)(l.Z,{variant:"caption",children:n&&d("usersList.itsYou")})]}),secondary:(0,f.jsx)(l.Z,{component:"span",variant:"body2",color:"Online"===(0,x.Tq)(e.timestamp)?m.Z[400]:p.Z[500],children:(0,x.Tq)(e.timestamp)})}),r&&r(e.uid)]}),b!==e.uid&&(0,f.jsx)(a.Z,{variant:"inset",component:"li"})]},e.uid)}))})}},6489:function(e,n,t){"use strict";var r=t(27812),i=t(50122),o=t(15861),s=t(12963),c=t(11163),l=t(26215),a=t(77058),u=t(85893);n.Z=function(e){var n=e.otherBreadcrumbs,t=e.breadcrumbText,d=e.breadcrumbTextHref,f=(0,c.useRouter)(),h=(0,a.$)().t,p=[(0,u.jsx)(i.Z,{underline:"hover",color:"inherit",href:"/",onClick:function(){return f.push("/")},children:h("dashboard.title")},"dashboard"),(0,u.jsx)(o.Z,{color:"text.primary",sx:{"&:hover":{cursor:null!==n&&void 0!==n&&n.length?"pointer":"default"}},onClick:function(){return(null===n||void 0===n?void 0:n.length)&&d&&f.push(d)},children:t},t)].concat((0,r.Z)(null!==n&&void 0!==n?n:[]));return(0,u.jsx)(s.Z,{separator:(0,u.jsx)(l.Z,{}),"aria-label":"breadcrumb",children:p})}},98187:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chats/[id]",function(){return t(27717)}])}},function(e){e.O(0,[885,229,228,463,138,524,584,551,976,40,153,774,888,179],(function(){return n=98187,e(e.s=n);var n}));var n=e.O();_N_E=n}]);