(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{1377:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return z}});var r=t(6687),o=t(9008),i=t(2132),c=t(6886),a=t(7357),s=t(5861),u=t(6893),l=t(7294),d=t(1102),f=function(e){var n=e.geolocation,t=e.onUserClick;return(0,l.createElement)(d.t,{geolocation:n,onUserClick:t})},p=t(1163),h=t(7305),m=t(7932),v=t(1795),x=t(6158),g=t.n(x),y=(t(1634),t(5113)),j=t(5893),b=function(e){var n=e.mapNode;return(0,j.jsx)(y.Z,{sx:{height:600},children:(0,j.jsx)("div",{ref:n,style:{width:"100%",height:"100%"}})})},Z=function(e,n){var t=new(g().Popup)({closeButton:!1,closeOnClick:!1});e.popup.addEventListener("mouseenter",(function(){e.popup.style.cursor="pointer",t.setLngLat(e.marker.geometry.coordinates).setHTML(e.marker.properties.description).addTo(n)})),e.popup.addEventListener("mouseleave",(function(){e.popup.style.cursor="",t.remove()})),new(g().Marker)(e.popup).setLngLat(e.marker.geometry.coordinates).addTo(n)},w=t(7028),k=function(){var e,n,t=(0,l.useState)(),r=t[0],o=t[1],i=(0,w.H)(),c=(0,l.useRef)(null),a=[null!==(e=null===i||void 0===i?void 0:i.coords.longitude)&&void 0!==e?e:24.065285,null!==(n=null===i||void 0===i?void 0:i.coords.latitude)&&void 0!==n?n:49.8138699];return(0,l.useEffect)((function(){var e=c.current;if(null!==e){var n=new(g().Map)({container:e,accessToken:"pk.eyJ1IjoidHJvbnlhIiwiYSI6ImNpdXNteHUwdzAwMWkyenBmamRlbTk2Zm8ifQ.aFKT4IOHyPCPRt_GNfUYnw",style:"mapbox://styles/mapbox/streets-v11",center:a,zoom:11});o(n)}}),[]),{mapboxMap:r,mapNode:c}};function O(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return C(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return C(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return c=e.done,e},e:function(e){a=!0,i=e},f:function(){try{c||null==t.return||t.return()}finally{if(a)throw i}}}}function C(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var E=function(e){var n=e.markers,t=e.selectedLocation,r=k(),o=r.mapboxMap,i=r.mapNode;return(0,l.useEffect)((function(){if(o)return o.addControl(new(g().GeolocateControl)({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})),function(){o.remove()}}),[o]),(0,l.useEffect)((function(){t&&o&&o.flyTo({center:[null===t||void 0===t?void 0:t.geolocationCoords.coords.longitude,null===t||void 0===t?void 0:t.geolocationCoords.coords.latitude],essential:!0,zoom:14})}),[o,t]),(0,l.useEffect)((function(){if(null!==n&&void 0!==n&&n.length&&o){var e,t=O(n);try{for(t.s();!(e=t.n()).done;){var r=e.value;Z(r,o)}}catch(i){t.e(i)}finally{t.f()}}}),[o,n]),(0,l.createElement)(b,{mapNode:i})},P=t(315),I=function(e,n){var t=[];n&&[n].concat((0,r.Z)(e)).map((function(e){return{properties:{description:e.user.displayName,iconSize:[40,40],backgroundImage:e.user.photoURL,displayName:e.user.displayName},geometry:{type:"Point",coordinates:[e.geolocationCoords.coords.longitude,e.geolocationCoords.coords.latitude]}}})).forEach((function(e){var n=document.createElement("div"),r=e.properties.iconSize[0],o=e.properties.iconSize[1];n.style.borderRadius="50%",n.style.backgroundRepeat="no-repeat",n.style.backgroundImage=e.properties.backgroundImage?"url(".concat(e.properties.backgroundImage,")"):"url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='30px' width='30px'><text x='6' y='20' fill='black' font-size='15'>".concat((0,P.Yd)(e.properties.displayName),'</text></svg>")'),n.style.width="".concat(r,"px"),n.style.height="".concat(o,"px"),n.style.backgroundSize="100%",t.push({popup:n,marker:e})}));return t},N=t(1035),S=t(1057),L=function(e){var n=e.buttonText,t=e.buttonHref,r=e.title,o=(0,p.useRouter)();return(0,j.jsx)(y.Z,{sx:{p:4},children:(0,j.jsxs)(c.ZP,{container:!0,children:[(0,j.jsx)(c.ZP,{item:!0,xs:10,sm:10,lg:10,children:(0,j.jsx)(s.Z,{variant:"h6",sx:{color:"common.white"},children:r})}),n&&t&&(0,j.jsx)(c.ZP,{item:!0,xs:2,sm:2,lg:2,children:(0,j.jsx)(a.Z,{display:"flex",justifyContent:"end",height:1,children:(0,j.jsx)(S.Z,{variant:"contained",sx:{backgroundColor:"white !important",color:"primary.main",textAlign:"center"},onClick:function(e){e.preventDefault(),t&&o.push(t)},href:t,children:n})})})]})})},T=t(2267),A=t(7058),_=function(e){return null!==e&&void 0!==e},U=t(9944),H=t(5321),R=t(2114),z=function(){var e=(0,l.useState)([]),n=e[0],t=e[1],d=(0,l.useState)([]),x=d[0],g=d[1],y=(0,l.useState)(null),b=y[0],Z=y[1],w=(0,p.useRouter)(),k=(0,A.$)().t,O=(0,v.a)(),C=O.user,P=O.loading,S=(0,T.Z)(),z=S.isLocationAllowed,M=S.user,D=x.map((function(e){if(null!==n&&void 0!==n&&n.find((function(n){return n===e.id})))return e})).filter(_),Y=I(D,M);if((0,l.useEffect)((function(){(0,N.Yt)().then((function(e){return g(e)})).catch((function(e){return i.Am.error(e)}))}),[]),(0,l.useEffect)((function(){if(null!==C&&void 0!==C&&C.uid){var e=(0,H.IO)((0,H.hJ)(R.DB,"favorites"),(0,H.ar)("id","==",null===C||void 0===C?void 0:C.uid));(0,H.cf)(e,(function(e){e.forEach((function(e){t(e.data().users)}))}))}}),[C]),(0,l.useEffect)((function(){P||C||w.push("/login")}),[C,P,w]),!C||!x.length||!M)return(0,j.jsx)(h.Z,{});return(0,j.jsxs)(m.Z,{children:[(0,j.jsxs)(o.default,{children:[(0,j.jsx)("title",{children:"whereiam"}),(0,j.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,j.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,j.jsx)("main",{children:z?(0,j.jsxs)(c.ZP,{container:!0,children:[(0,j.jsxs)(c.ZP,{item:!0,xs:12,sm:6,lg:3,children:[(0,j.jsxs)(a.Z,{display:"flex",alignItems:"center",py:2,mr:2,children:[(0,j.jsx)(s.Z,{variant:"h4",children:k("dashboard.peopleYouFollow")}),(0,j.jsx)(u.Z,{title:k("dashboard.tooltip"),placement:"top",children:(0,j.jsx)(a.Z,{ml:1,children:(0,j.jsx)(U.Z,{sx:{width:15,height:15}})})})]}),(0,j.jsx)(f,{geolocation:[M].concat((0,r.Z)(D)),onUserClick:function(e){return Z(e)}})]}),(0,j.jsx)(c.ZP,{item:!0,xs:12,sm:6,lg:9,children:(0,j.jsx)(E,{markers:Y,selectedLocation:b})})]}):(0,j.jsx)(L,{title:k("dashboard.bannerTitle"),buttonText:k("dashboard.bannerButtonText"),buttonHref:"/user/profile"})})]})}},1102:function(e,n,t){"use strict";t.d(n,{t:function(){return P}});var r,o,i=t(9499),c=t(7212),a=t(8987),s=t(9661),u=t(9953),l=t(5861),d=t(1519),f=t(8462),p=t(8078),h=t(5893),m=function(e){for(var n=e.count,t=[],r=0;r<n;r++)t.push(r);return(0,h.jsx)(f.Z,{sx:{width:240},children:t.map((function(e,n){return(0,h.jsxs)(c.ZP,{alignItems:"flex-start",children:[(0,h.jsx)(a.Z,{children:(0,h.jsx)(p.Z,{variant:"circular",width:40,height:40})}),(0,h.jsx)(u.Z,{primary:(0,h.jsx)(p.Z,{variant:"text"}),secondary:(0,h.jsx)(l.Z,{component:"span",variant:"body2",children:(0,h.jsx)(p.Z,{variant:"text"})})})]},n)}))})},v=t(7036),x=t(3486),g=t(1383),y=t(7357),j=t(5137),b=t(8797),Z=(0,b.ZP)(f.Z)(r||(r=(0,g.Z)(["\n  @media (max-width: 599px) {\n    margin-right: unset;\n  }\n"]))),w=(0,b.ZP)(y.Z)(o||(o=(0,g.Z)(["\n  &:hover {\n    li {\n      svg {\n        color: ",";\n      }\n    }\n  }\n"])),j.Z[500]),k=t(315),O=t(1795);function C(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function E(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?C(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var P=function(e){var n=e.geolocation,t=e.onUserClick,r=e.starIcon,o=(0,O.a)().user;if(!n.length)return(0,h.jsx)(m,{count:6});var i=n[n.length-1].user.uid;return(0,h.jsx)(Z,{sx:{mr:2,mb:2,bgcolor:"background.paper"},children:n.map((function(e){var n=e.user,f=e.geolocationCoords,p=n.uid===(null===o||void 0===o?void 0:o.uid);return(0,h.jsxs)(w,{onClick:function(){return t(e)},sx:{cursor:"pointer"},children:[(0,h.jsxs)(c.ZP,{alignItems:"center",children:[(0,h.jsx)(a.Z,{children:(0,h.jsx)(s.Z,E({alt:n.displayName,src:n.photoURL},(0,k.GZ)(n.displayName)))}),(0,h.jsx)(u.Z,{sx:{color:v.Z[300]},primary:(0,h.jsxs)(h.Fragment,{children:[n.displayName,(0,h.jsx)(l.Z,{variant:"caption",children:p&&" (It's you)"})]}),secondary:(0,h.jsx)(l.Z,{component:"span",variant:"body2",color:"Online"===(0,k.Tq)(f.timestamp)?x.Z[400]:v.Z[500],children:(0,k.Tq)(f.timestamp)})}),r&&r(e.id)]}),i!==n.uid&&(0,h.jsx)(d.Z,{variant:"inset",component:"li"})]},n.uid)}))})}},7305:function(e,n,t){"use strict";var r=t(8456),o=t(7357),i=t(4106),c=t(5893);n.Z=function(){return(0,c.jsx)(o.Z,{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100vh",children:(0,c.jsx)(r.Z,{size:100,sx:{color:i.Z.palette.primary.main}})})}},2267:function(e,n,t){"use strict";var r=t(7294),o=t(2132),i=t(1035),c=t(1795);n.Z=function(){var e,n=(0,r.useState)([]),t=n[0],a=n[1],s=(0,c.a)().user;(0,r.useEffect)((function(){(0,i.Yt)().then((function(e){return a(e)})).catch((function(e){return o.Am.error(e)}))}),[]);var u=t.find((function(e){return e.user.uid===(null===s||void 0===s?void 0:s.uid)}));return{user:u,isLocationAllowed:null!==(e=null===u||void 0===u?void 0:u.geolocationCoords.allowLocation)&&void 0!==e&&e}}},7028:function(e,n,t){"use strict";t.d(n,{H:function(){return l},K:function(){return d}});var r=t(1163),o=t(7294),i=t(7058),c=t(2132),a=t(1035),s=t(1795),u=t(5893),l=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=(0,r.useRouter)(),t=(0,i.$)(),a=t.t,s=(0,o.useState)(),u=s[0],l=s[1];return(0,o.useEffect)((function(){e&&navigator.geolocation.getCurrentPosition((function(e){l(e),c.Am.success(a("toastSuccess.acceptGeolocation")),n.push("/")}),(function(e){c.Am.error(e.message)}))}),[e,n,a]),u},d=function(e){var n=e.acceptLocation,t=e.children,r=l(n),i=(0,s.a)();return(0,o.useEffect)((function(){r&&(0,a.CC)(r,i)}),[r,i]),(0,u.jsx)(u.Fragment,{children:t})}},5301:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(1377)}])}},function(e){e.O(0,[885,634,389,582,324,883,699,774,888,179],(function(){return n=5301,e(e.s=n);var n}));var n=e.O();_N_E=n}]);