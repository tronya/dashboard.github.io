(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5616:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return X}});var t,o,i=r(9008),s=r(2132),a=r(6886),c=r(7294),u=r(7357),l=r(891),d=r(8987),p=r(9661),f=r(9953),h=r(5861),x=r(1519),g=r(8462),j=r(8078),m=r(5893),v=function(e){for(var n=e.count,r=[],t=0;t<n;t++)r.push(t);return(0,m.jsx)(g.Z,{sx:{width:240},children:r.map((function(e,n){return(0,m.jsxs)(l.ZP,{alignItems:"flex-start",children:[(0,m.jsx)(d.Z,{children:(0,m.jsx)(j.Z,{variant:"circular",width:40,height:40})}),(0,m.jsx)(f.Z,{primary:(0,m.jsx)(j.Z,{variant:"text"}),secondary:(0,m.jsx)(h.Z,{component:"span",variant:"body2",children:(0,m.jsx)(j.Z,{variant:"text"})})})]},n)}))})},y=r(7036),b=r(3486),Z=r(1383),w=(0,r(8797).ZP)(g.Z)(t||(t=(0,Z.Z)(["\n  @media (max-width: 599px) {\n    margin-right: unset;\n  }\n"]))),O=r(381),P=r.n(O);!function(e){e.OFFLINE="Offline",e.ONLINE="Online"}(o||(o={}));var k=function(e){var n=P()().valueOf(),r=P()(n).diff(P()(e));return+P()(r).format("m")>5?o.OFFLINE:o.ONLINE},S=r(1795),C=function(e){var n=e.geolocation,r=e.onUserClick,t=(0,S.a)().user;if(!n.length)return(0,m.jsx)(v,{count:6});var o=n[n.length-1].user.uid;return(0,m.jsx)(w,{sx:{mr:2,mb:2,bgcolor:"background.paper"},children:n.map((function(e){var n=e.user,i=e.geolocationCoords,s=n.uid===(null===t||void 0===t?void 0:t.uid);return(0,m.jsxs)(u.Z,{onClick:function(){return r(e)},sx:{cursor:"pointer"},children:[(0,m.jsxs)(l.ZP,{alignItems:"flex-start",children:[(0,m.jsx)(d.Z,{children:(0,m.jsx)(p.Z,{alt:n.displayName,src:n.photoURL})}),(0,m.jsx)(f.Z,{sx:{color:y.Z[300]},primary:(0,m.jsxs)(m.Fragment,{children:[n.displayName,(0,m.jsx)(h.Z,{variant:"caption",children:s&&" (It's you)"})]}),secondary:(0,m.jsx)(h.Z,{component:"span",variant:"body2",color:"Online"===k(i.timestamp)?b.Z[400]:y.Z[500],children:k(i.timestamp)})})]}),o!==n.uid&&(0,m.jsx)(x.Z,{variant:"inset",component:"li"})]},n.uid)}))})},E=function(e){var n=e.geolocation,r=e.onUserClick;return(0,c.createElement)(C,{geolocation:n,onUserClick:r})},D=r(1163),I=r(8456),N=r(4106),L=function(){return(0,m.jsx)(u.Z,{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100vh",children:(0,m.jsx)(I.Z,{size:100,sx:{color:N.Z.palette.primary.main}})})},U=r(7932),A=r(6158),R=r.n(A),T=(r(1634),r(7028)),_=r(5113),z=function(e){var n=e.mapNode;return(0,m.jsx)(_.Z,{sx:{height:600},children:(0,m.jsx)("div",{ref:n,style:{width:"100%",height:"100%"}})})};function F(e,n){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return H(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var t=0,o=function(){};return{s:o,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw i}}}}function H(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}var M=function(e){var n,r,t=e.map,o=e.onSetMap,i=e.markers,s=e.selectedLocation,a=(0,T.H)(),u=(0,c.useRef)(null),l=[null!==(n=null===a||void 0===a?void 0:a.coords.longitude)&&void 0!==n?n:24.065285,null!==(r=null===a||void 0===a?void 0:a.coords.latitude)&&void 0!==r?r:49.8138699];return(0,c.useEffect)((function(){var e=u.current;if(null!==e){var n=new(R().Map)({container:e,accessToken:"pk.eyJ1IjoidHJvbnlhIiwiYSI6ImNpdXNteHUwdzAwMWkyenBmamRlbTk2Zm8ifQ.aFKT4IOHyPCPRt_GNfUYnw",style:"mapbox://styles/mapbox/streets-v11",center:l,zoom:11});if(null!==i&&void 0!==i&&i.length){var r,t=F(i);try{for(t.s();!(r=t.n()).done;){var s=r.value;new(R().Marker)(s.popup).setLngLat(s.marker.geometry.coordinates).addTo(n)}}catch(a){t.e(a)}finally{t.f()}}return n.addControl(new(R().GeolocateControl)({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})),o(n),function(){n.remove()}}}),[]),(0,c.useEffect)((function(){s&&t&&t.flyTo({center:[null===s||void 0===s?void 0:s.geolocationCoords.coords.longitude,null===s||void 0===s?void 0:s.geolocationCoords.coords.latitude],essential:!0,zoom:14})}),[t,s]),(0,c.createElement)(z,{mapNode:u})},G=r(1035),Y=function(e){var n=(0,c.useState)([]),r=n[0],t=n[1],o=[];return(0,c.useEffect)((function(){(0,G.Yt)().then((function(e){return t(e)})).catch((function(e){return s.Am.error(e)}))}),[]),function(e){return e.map((function(e){return{properties:{description:e.user.displayName,iconSize:[40,40],backgroundImage:e.user.photoURL},geometry:{type:"Point",coordinates:[e.geolocationCoords.coords.longitude,e.geolocationCoords.coords.latitude]}}}))}(r).forEach((function(n){var r=document.createElement("div"),t=n.properties.iconSize[0],i=n.properties.iconSize[1];r.style.borderRadius="50%",r.style.backgroundImage="url(".concat(n.properties.backgroundImage,")"),r.style.width="".concat(t,"px"),r.style.height="".concat(i,"px"),r.style.backgroundSize="100%",r.style.boxShadow="2px 2px 8px rgba(0, 0, 0, 0.5)";var s=new(R().Popup)({closeButton:!1,closeOnClick:!1});r.addEventListener("mouseenter",(function(){e&&(r.style.cursor="pointer",s.setLngLat(n.geometry.coordinates).setHTML(n.properties.description).addTo(e))})),r.addEventListener("mouseleave",(function(){r.style.cursor="",s.remove()})),o.push({popup:r,marker:n})})),o},X=function(){var e=(0,c.useState)(),n=e[0],r=e[1],t=(0,c.useState)([]),o=t[0],u=t[1],l=(0,c.useState)(null),d=l[0],p=l[1],f=(0,D.useRouter)(),h=Y(n),x=(0,S.a)(),g=x.user,j=x.loading;if((0,c.useEffect)((function(){(0,G.Yt)().then((function(e){return u(e)})).catch((function(e){return s.Am.error(e)}))}),[]),(0,c.useEffect)((function(){j||g||f.push("/login")}),[g,j,f]),!g||!o.length)return(0,m.jsx)(L,{});return(0,m.jsxs)(U.Z,{children:[(0,m.jsxs)(i.default,{children:[(0,m.jsx)("title",{children:"whereiam"}),(0,m.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,m.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,m.jsx)("main",{children:(0,m.jsxs)(a.ZP,{container:!0,children:[(0,m.jsx)(a.ZP,{item:!0,xs:12,sm:6,lg:3,children:(0,m.jsx)(E,{geolocation:o,onUserClick:function(e){return p(e)}})}),(0,m.jsx)(a.ZP,{item:!0,xs:12,sm:6,lg:9,children:(0,m.jsx)(M,{markers:h,map:n,onSetMap:r,selectedLocation:d})})]})})]})}},4106:function(e,n,r){"use strict";var t=(0,r(3274).Z)({palette:{mode:"light",primary:{main:"#264f9e"},secondary:{main:"#455fb4"},background:{paper:"#2d56a5"}}});n.Z=t},7932:function(e,n,r){"use strict";r.d(n,{Z:function(){return K}});var t=r(1927),o=r(155),i=r(7948),s=r(7357),a=r(6720),c=r(7294),u=r(5438),l=r(891),d=r(796),p=r(9953),f=r(3946),h=r(1519),x=r(8462),g=r(9572),j=r(1098),m=r(9499),v=r(1496),y=r(7533);function b(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function Z(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?b(Object(r),!0).forEach((function(n){(0,m.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var w=(0,v.ZP)(y.ZP,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var n=e.theme,r=e.open;return{"& .MuiDrawer-paper":Z({position:"relative",whiteSpace:"nowrap",width:240,transition:n.transitions.create("width",{easing:n.transitions.easing.sharp,duration:n.transitions.duration.enteringScreen}),boxSizing:"border-box"},!r&&(0,m.Z)({overflowX:"hidden",transition:n.transitions.create("width",{easing:n.transitions.easing.sharp,duration:n.transitions.duration.leavingScreen}),width:n.spacing(7)},n.breakpoints.up("sm"),{width:n.spacing(9)}))}})),O=r(5893),P=(0,O.jsxs)(s.Z,{children:[(0,O.jsx)(u.Z,{inset:!0,children:"Saved reports"}),(0,O.jsxs)(l.ZP,{button:!0,children:[(0,O.jsx)(d.Z,{children:(0,O.jsx)(j.Z,{})}),(0,O.jsx)(p.Z,{primary:"Current month"})]})]}),k=function(e){var n=e.toggleDrawer,r=e.open;return(0,O.jsxs)(w,{variant:"permanent",open:r,children:[(0,O.jsx)(o.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",px:[1]},children:(0,O.jsx)(f.Z,{onClick:n,children:(0,O.jsx)(g.Z,{})})}),(0,O.jsx)(h.Z,{}),(0,O.jsx)(x.Z,{children:P})]})},S=r(5861),C=r(6893),E=r(9661),D=r(326),I=r(2293);function N(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}var L=(0,v.ZP)(I.Z,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var n=e.theme,r=e.open;return function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?N(Object(r),!0).forEach((function(n){(0,m.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({zIndex:n.zIndex.drawer+1,transition:n.transitions.create(["width","margin"],{easing:n.transitions.easing.sharp,duration:n.transitions.duration.leavingScreen})},r&&{marginLeft:240,width:"calc(100% - ".concat(240,"px)"),transition:n.transitions.create(["width","margin"],{easing:n.transitions.easing.sharp,duration:n.transitions.duration.enteringScreen})})})),U=r(7058),A=r(6863),R=r(1057),T=function(){var e=(0,U.$)().i18n,n=function(n){return e.changeLanguage(n.currentTarget.value)};return(0,O.jsxs)(A.Z,{variant:"contained",children:[(0,O.jsx)(R.Z,{onClick:n,value:"en",children:"EN"}),(0,O.jsx)(R.Z,{onClick:n,value:"ua",children:"UA"})]})},_=r(2132),z=r(8530),F=r(8878),H=r(1163),M=[{href:"/user/profile",text:"User Profile"}],G=function(){var e=(0,H.useRouter)();return(0,O.jsxs)(s.Z,{pt:8,children:[(0,O.jsx)(x.Z,{children:M.map((function(n){return(0,O.jsxs)(l.ZP,{button:!0,href:n.href,onClick:function(r){return function(n,r){n.preventDefault(),e.push(r)}(r,n.href)},children:[(0,O.jsx)(d.Z,{children:(0,O.jsx)(F.Z,{sx:{color:"white"}})}),(0,O.jsx)(p.Z,{primary:n.text,sx:{color:"white"}})]},n.text)}))}),(0,O.jsx)(h.Z,{})]})},Y=function(e){var n=e.open,r=e.toggleUserDrawer,t=(0,z.v0)(),o=(0,H.useRouter)();return(0,O.jsx)(y.ZP,{anchor:"right",open:n,onClose:r(!1),children:(0,O.jsxs)(s.Z,{width:250,height:"100%",role:"presentation",display:"flex",justifyContent:"space-between",flexDirection:"column",onClick:r(!1),onKeyDown:r(!1),children:[(0,O.jsx)(G,{}),(0,O.jsx)(s.Z,{p:2,display:"flex",justifyContent:"center",children:(0,O.jsx)(R.Z,{onClick:function(){return(0,z.w7)(t).then((function(){_.Am.success("You successfully log out!"),o.push("/login")})).catch((function(e){return _.Am.error("Error: ".concat(e))}))},variant:"contained",size:"large",children:"SIGH OUT"})})]})})},X=r(1795);function W(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function $(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?W(Object(r),!0).forEach((function(n){(0,m.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var B=function(e){var n=e.toggleDrawer,r=e.open,t=(0,U.$)().t,i=(0,X.a)().user,a=(0,H.useRouter)(),u=(0,c.useState)(!1),l=u[0],d=u[1];return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(L,{position:"absolute",open:r,children:(0,O.jsxs)(o.Z,{sx:{pr:"24px"},children:[(0,O.jsx)(f.Z,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:n,sx:$({marginRight:"36px"},r&&{display:"none"}),children:(0,O.jsx)(D.Z,{})}),(0,O.jsx)(S.Z,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,sx:{flexGrow:1,cursor:"pointer"},onClick:function(e){e.preventDefault(),a.push("/")},children:t("dashboard")}),(0,O.jsx)(s.Z,{pr:1,children:(0,O.jsx)(T,{})}),i&&i.displayName&&i.photoURL&&(0,O.jsx)(C.Z,{title:"Open settings",children:(0,O.jsx)(f.Z,{sx:{p:0},onClick:function(){return d((function(e){return!e}))},children:(0,O.jsx)(E.Z,{alt:i.displayName,src:i.photoURL})})})]})}),(0,O.jsx)(Y,{open:l,toggleUserDrawer:function(e){return function(n){if("keydown"===n.type&&("Tab"===n.key||"Shift"===n.key))return null;d(e)}}})]})},J=r(4106),K=function(e){var n=e.children,r=(0,c.useState)(!1),u=r[0],l=r[1],d=function(){return l(!u)};return(0,O.jsx)(t.Z,{theme:J.Z,children:(0,O.jsxs)(s.Z,{sx:{display:"flex"},children:[(0,O.jsx)(a.ZP,{}),(0,O.jsx)(B,{open:u,toggleDrawer:d}),(0,O.jsx)(k,{open:u,toggleDrawer:d}),(0,O.jsxs)(s.Z,{component:"main",sx:{flexGrow:1,height:"100vh",overflow:"auto"},children:[(0,O.jsx)(o.Z,{}),(0,O.jsx)(i.Z,{maxWidth:"xl",sx:{mt:2,mb:2},children:n})]})]})})}},5301:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(5616)}])}},function(e){e.O(0,[885,634,260,806,196,774,888,179],(function(){return n=5301,e(e.s=n);var n}));var n=e.O();_N_E=n}]);