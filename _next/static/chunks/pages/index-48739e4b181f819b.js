(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{1776:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return H}});var r=n(9008),o=n(7357),i=n(1163),a=n(7294),c=n(240),s=n(8332),u=n(6001),l=n(6158),d=n.n(l),p=(n(1634),n(5113)),f=n(5893),h=function(e){var t=e.mapNode;return(0,f.jsx)(p.Z,{sx:{height:"calc(100vh - 155px)"},children:(0,f.jsx)("div",{ref:t,style:{width:"100%",height:"100%"}})})},m=function(e,t){var n=new(d().Popup)({closeButton:!1,closeOnClick:!1});e.popup.addEventListener("mouseenter",(function(){e.popup.style.cursor="pointer",e.marker.properties.description&&n.setLngLat(e.marker.geometry.coordinates).setHTML(e.marker.properties.description).addTo(t)})),e.popup.addEventListener("mouseleave",(function(){e.popup.style.cursor="",n.remove()})),new(d().Marker)(e.popup).setLngLat(e.marker.geometry.coordinates).addTo(t)},v=function(){var e=(0,a.useState)(),t=e[0],n=e[1],r=(0,a.useRef)(null),o=[24.065285,49.8138699];return(0,a.useEffect)((function(){var e=r.current;if(null!==e){var t=new(d().Map)({container:e,accessToken:"pk.eyJ1IjoidHJvbnlhIiwiYSI6ImNpdXNteHUwdzAwMWkyenBmamRlbTk2Zm8ifQ.aFKT4IOHyPCPRt_GNfUYnw",style:"mapbox://styles/tronya/cixa87ptp00g12qo9jjbqm9mk",center:o,zoom:11});n(t)}}),[]),{mapboxMap:t,mapNode:r}};function x(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=function(e){var t=e.markers,n=e.selectedUser,r=v(),o=r.mapboxMap,i=r.mapNode;return(0,a.useEffect)((function(){if(o)return o.addControl(new(d().GeolocateControl)({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})),function(){o.remove()}}),[o]),(0,a.useEffect)((function(){n&&o&&o.flyTo({center:[null===n||void 0===n?void 0:n.coords.longitude,null===n||void 0===n?void 0:n.coords.latitude],essential:!0,zoom:14})}),[o,n]),(0,a.useEffect)((function(){if(null!==t&&void 0!==t&&t.length&&o){var e,n=x(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;m(r,o)}}catch(i){n.e(i)}finally{n.f()}}}),[o,t]),(0,a.createElement)(h,{mapNode:i})},w=n(315),b=function(e){var t=[];return function(e){return e.map((function(e){return{properties:{description:e.displayName,iconSize:[40,40],backgroundImage:e.photoURL,displayName:e.displayName},geometry:{type:"Point",coordinates:[e.coords.longitude,e.coords.latitude]}}}))}(e).forEach((function(e){var n=document.createElement("div"),r=e.properties.iconSize[0],o=e.properties.iconSize[1];n.style.borderRadius="50%",n.style.backgroundRepeat="no-repeat",n.style.backgroundImage=e.properties.backgroundImage?"url(".concat(e.properties.backgroundImage,")"):"url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='30px' width='30px'><text x='6' y='20' fill='black' font-size='15'>".concat((0,w.Yd)(e.properties.displayName),'</text></svg>")'),n.style.width="".concat(r,"px"),n.style.height="".concat(o,"px"),n.style.backgroundSize="100%",t.push({popup:n,marker:e})})),t},j=n(6886),k=n(5861),T=n(1057),E=function(e){var t=e.buttonText,n=e.buttonHref,r=e.title,a=(0,i.useRouter)();return(0,f.jsx)(p.Z,{sx:{p:4},children:(0,f.jsxs)(j.ZP,{container:!0,children:[(0,f.jsx)(j.ZP,{item:!0,xs:10,sm:10,lg:10,children:(0,f.jsx)(k.Z,{variant:"h6",sx:{color:"common.white"},children:r})}),t&&n&&(0,f.jsx)(j.ZP,{item:!0,xs:2,sm:2,lg:2,children:(0,f.jsx)(o.Z,{display:"flex",justifyContent:"end",height:1,children:(0,f.jsx)(T.Z,{variant:"contained",sx:{backgroundColor:"white !important",color:"primary.main",textAlign:"center"},onClick:function(e){e.preventDefault(),n&&a.push(n)},href:n,children:t})})})]})})},Z=n(7058),N=n(3936),L=n(6870),I=n(3984),S=n(7952),A=n(8459),C=function(){var e=(0,a.useState)(window.innerWidth),t=e[0],n=e[1],r=(0,a.useState)(A.T.INITIAL),o=r[0],i=r[1];return(0,a.useEffect)((function(){var e=function(){n(window.innerWidth)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),(0,a.useEffect)((function(){i(t>1300?A.T.DESKTOP:t<=1300&&t>800?A.T.TABLET:A.T.MOBILE)}),[t]),{screenType:o,windowWidth:t}},O=n(2763),_=n(1107),z=n(8078),P=function(e){for(var t=e.count,n=[],r=0;r<t;r++)n.push(r);return(0,f.jsx)(_.Z,{max:t,total:t,children:n.map((function(e){return(0,f.jsx)(O.j8,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",children:(0,f.jsx)(z.Z,{variant:"circular",width:50,height:50})},e)}))})},U=function(e){var t=e.users,n=e.onUserClick,r=C().screenType;if(!t.length)return(0,f.jsx)(P,{count:5});var o=r===A.T.DESKTOP?10:r===A.T.TABLET?7:4;return(0,f.jsx)(O.PJ,{max:o,total:t.length,children:t.map((function(e){return(0,f.jsx)(O.j8,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"dot",onClick:function(){return n(e)},sx:{cursor:"pointer"},color:"Online"===(0,w.Tq)(e.timestamp)?"success":"error",children:(0,f.jsx)(I.Z,{title:e.displayName,placement:"bottom",arrow:!0,children:(0,f.jsx)(S.Z,{alt:e.displayName,src:e.photoURL,sx:{width:50,height:50}})})},e.uid)}))})},R=n(9274),H=function(){var e=(0,a.useState)(null),t=e[0],n=e[1],l=(0,i.useRouter)(),d=(0,Z.$)().t,p=(0,u.a)(),h=p.user,m=p.loading,v=(0,L.ZA)().isLocationAllowed,x=(0,N.Z)(),g=b(x);if((0,a.useEffect)((function(){m||h||l.push("/login")}),[h,m,l]),!x)return(0,f.jsx)(c.Z,{});return(0,f.jsxs)(s.Z,{children:[(0,f.jsxs)(r.default,{children:[(0,f.jsx)("title",{children:"whereiam"}),(0,f.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,f.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,f.jsx)("main",{children:v?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(R.Z,{title:d("dashboard.users")}),(0,f.jsx)(o.Z,{display:"flex",p:1,children:(0,f.jsx)(U,{users:x,onUserClick:function(e){return n(e)}})}),(0,f.jsx)(y,{markers:g,selectedUser:t})]}):(0,f.jsx)(E,{title:d("dashboard.bannerTitle"),buttonText:d("dashboard.bannerButtonText"),buttonHref:"/user/profile"})})]})}},9274:function(e,t,n){"use strict";var r=n(5861),o=n(5893);t.Z=function(e){var t=e.title;return(0,o.jsx)(r.Z,{variant:"h3",component:"div",children:t})}},5301:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(1776)}])}},function(e){e.O(0,[885,634,701,953,481,217,162,774,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);