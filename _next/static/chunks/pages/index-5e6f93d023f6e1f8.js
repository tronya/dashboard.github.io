(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{68082:function(t,e,n){"use strict";var r;n.d(e,{G:function(){return r}}),function(t){t.FAVORITES="favorites",t.GROUPS="groups",t.USERS="users",t.USERS_GEOLOCATION="usersGeolocation",t.CHATS="chats"}(r||(r={}))},22320:function(t,e,n){"use strict";n.d(e,{wZ:function(){return c},xf:function(){return s},Qc:function(){return u}});var r=n(87663),o=n(92114),i=n(68082),a=n(18459),c=function(t,e){var n;return{coords:{accuracy:t.coords.accuracy,altitude:t.coords.altitude,altitudeAccuracy:t.coords.altitudeAccuracy,heading:t.coords.heading,latitude:t.coords.latitude,longitude:t.coords.longitude,speed:t.coords.speed},timestamp:t.timestamp,displayName:e.displayName,photoURL:e.photoURL,uid:null!==(n=e.uid)&&void 0!==n?n:""}},s=function(t,e){return(0,r.t8)((0,r.iH)(o.UO,"".concat(i.G.USERS_GEOLOCATION,"/").concat(t)),e)},u=function(t,e){return fetch("".concat(a.gg).concat(t,",").concat(e,".json?limit=1&types=region&access_token=").concat("pk.eyJ1IjoidHJvbnlhIiwiYSI6ImNpdXNteHUwdzAwMWkyenBmamRlbTk2Zm8ifQ.aFKT4IOHyPCPRt_GNfUYnw")).then((function(t){return t.json()}))}},35498:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return at}});var r,o=n(9008),i=n(11163),a=n(67294),c=n(74447),s=n(66001),u=n(32442),l=n(33580),d=n(55113),f=n(86886),p=n(15861),h=n(87357),m=n(11057),g=n(85893),v=function(t){var e=t.buttonText,n=t.buttonHref,r=t.title,o=(0,i.useRouter)();return(0,g.jsx)(d.Z,{sx:{p:4},children:(0,g.jsxs)(f.ZP,{container:!0,children:[(0,g.jsx)(f.ZP,{item:!0,xs:10,sm:10,lg:10,children:(0,g.jsx)(p.Z,{variant:"h6",sx:{color:"common.white"},children:r})}),e&&n&&(0,g.jsx)(f.ZP,{item:!0,xs:2,sm:2,lg:2,children:(0,g.jsx)(h.Z,{display:"flex",justifyContent:"end",height:1,children:(0,g.jsx)(m.Z,{variant:"contained",sx:{backgroundColor:"white !important",color:"primary.main",textAlign:"center"},onClick:function(t){t.preventDefault(),n&&o.push(n)},href:n,children:e})})})]})})},x=n(77058),y=n(43936),b=n(15101),j=n(9798),w=n(49274),Z=n(79951),k=n(29009),S=n(4668),E=n(3023),O=n(75358),I=n(14888),N=n(14195),T=n(66538),P=n(43815),L=function(t){var e=t.active,n=t.payload,r=t.label;return e?(0,g.jsxs)(h.Z,{bgcolor:"white",p:2,children:[(0,g.jsx)(p.Z,{variant:"body1",sx:{color:null===n||void 0===n?void 0:n[0].payload.fill},fontWeight:"bold",children:r}),(0,g.jsx)(p.Z,{variant:"body1",color:"black",children:"Total: ".concat(null===n||void 0===n?void 0:n[0].value)})]}):null},A=function(t){var e=t.data;return(0,g.jsx)(k.h,{width:"95%",height:"95%",children:(0,g.jsxs)(S.v,{width:250,height:200,data:e,margin:{top:10,right:0,left:0,bottom:10},barSize:25,children:[(0,g.jsx)(E.K,{dataKey:"name",scale:"point",padding:{left:10,right:10}}),(0,g.jsx)(O.B,{allowDecimals:!1}),(0,g.jsx)(I.u,{content:(0,g.jsx)(L,{})}),(0,g.jsx)(N.q,{strokeDasharray:"3 3"}),(0,g.jsx)(T.$,{dataKey:"total",name:"Total",children:e.map((function(t){return(0,g.jsx)(P.b,{fill:t.fill},"cell-".concat(t.name))}))})]})})},C=function(t){var e=t.data,n=t.title;return(0,g.jsxs)(d.Z,{sx:{height:250,width:"100%",padding:2},children:[(0,g.jsx)(p.Z,{variant:"h6",children:n}),(0,g.jsx)(A,{data:e})]})},R=n(59499),U=n(27812),_=n(16835),z=n(22320),D=n(18459),H=n(70315);function J(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?J(Object(n),!0).forEach((function(e){(0,R.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}!function(t){t.CITIES="cities",t.STATUSES="statuses"}(r||(r={}));var F,G=function(t,e){var n=0;return Object.entries(t).map((function(t){var r=(0,_.Z)(t,2),o=r[0],i=r[1],a=D.DM[n];return++n>D.DM.length-1&&(n=0),{name:o,total:i,fill:"cities"===e?a:o===H.J0.ONLINE?"#66bb6a":"#f44336"}}))},W=function(t){var e,n=(0,a.useState)([]),o=n[0],i=n[1];(0,a.useEffect)((function(){t.forEach((function(t){(0,z.Qc)(t.coords.longitude,t.coords.latitude).then((function(e){var n=e.features[0].text;i((function(e){return[].concat((0,U.Z)(e),[M(M({},t),{},{region:n})])}))}))}))}),[t]);var c=(0,U.Z)(new Map(o.map((function(t){return[t.uid,t]}))).values()).reduce((function(t,e){return t[e.region]?t[e.region]+=1:t[e.region]=1,t}),{}),s=t.reduce((function(t,e){return(0,H.Tq)(e.timestamp)===H.J0.ONLINE&&(t[H.J0.ONLINE]+=1),(0,H.Tq)(e.timestamp)===H.J0.OFFLINE&&(t[H.J0.OFFLINE]+=1),t}),(e={},(0,R.Z)(e,H.J0.ONLINE,0),(0,R.Z)(e,H.J0.OFFLINE,0),e));return{statusesData:G(s,r.STATUSES),citiesData:G(c,r.CITIES)}},B=n(87305),Q=n(57922),Y=n(73350),q=n(11496),K=(0,q.ZP)("span")((function(t){var e,n=t.theme;return e={fontSize:"4rem",fontWeight:900,lineHeight:".8",flexDirection:"column",textAlign:"center",color:n.palette.primary.contrastText,display:"block"},(0,R.Z)(e,n.breakpoints.up("md"),{fontSize:"6rem"}),(0,R.Z)(e,n.breakpoints.up("xl"),{fontSize:"8rem"}),e})),X=(0,q.ZP)(h.Z)((function(t){return{backgroundColor:t.theme.palette.common.black,flexWrap:"wrap",flexDirection:"column",width:"100vw",height:"100vh",display:"flex",textAlign:"center",alignItems:"end",justifyContent:"flex-end",paddingRight:"2rem"}})),V=(0,q.ZP)(K)((function(t){var e=t.theme;return{transform:"rotateX(145deg)","&:after":(0,R.Z)({content:'""',display:"block",position:"absolute",width:"100%",height:"100%",background:"linear-gradient(0deg, rgba(0,0,0,.5) 20%, rgba(0,0,0,.9) 35%,rgba(0,0,0,1) 50%)",bottom:"0rem"},e.breakpoints.up("md"),{bottom:"0rem"})}})),$=["Where","I","Am","???"],tt=function(){var t=(0,a.useState)(["..."]),e=t[0],n=t[1],r=(0,i.useRouter)();(0,a.useEffect)((function(){o(0)}),[]);var o=function(t){t===$.length&&(!function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];window.localStorage.setItem("splashScreenViewed",String(t))}(!0),setTimeout((function(){r.reload()}),2e3)),setTimeout((function(){n([].concat((0,U.Z)(e),[$[t]]))}),800)};return(0,g.jsx)(X,{children:(0,g.jsx)(Y.Z,{children:e.map((function(t,e){return(0,g.jsxs)(Q.Z,{orientation:"horizontal",in:!0,onEnter:function(t){return o(e)},children:[(0,g.jsx)(K,{children:t}),(0,g.jsx)(V,{children:t})]},t)}))})})},et=n(71383),nt=n(8797),rt=n(14113),ot=(0,nt.ZP)(rt.Z)(F||(F=(0,et.Z)(["\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  height: 40px;\n  width: 40px;\n  z-index: 1000;\n  cursor: pointer;\n  animation: fadeIn 0.3s;\n  transition: opacity 0.4s;\n  opacity: 0.5;\n\n  &:hover {\n    opacity: 1;\n  }\n\n  @keyframes fadeIn {\n    0% {\n      opacity: 0;\n    }\n    100% {\n      opacity: 0.5;\n    }\n  }\n"]))),it=function(){var t=(0,a.useState)(!1),e=t[0],n=t[1];return(0,a.useEffect)((function(){var t=function(){window.pageYOffset>100?n(!0):n(!1)};return window.addEventListener("scroll",t),function(){return window.removeEventListener("scroll",t)}}),[]),(0,g.jsx)(ot,{onClick:function(){window.scrollTo({top:0,behavior:"smooth"})},style:{display:e?"flex":"none"}})},at=function(){var t=(0,a.useState)(null),e=t[0],n=t[1],r=(0,i.useRouter)(),d=(0,x.$)().t,p=(0,s.a)(),h=p.user,m=p.loading,k=(0,b.ZA)().isLocationAllowed,S=(0,y.Z)(),E=W(S),O=E.statusesData,I=E.citiesData,N=(0,l.Z)(S);if((0,a.useEffect)((function(){m||h||r.push("/sign-in")}),[h,m,r]),!Boolean(localStorage.getItem("splashScreenViewed")))return(0,g.jsx)(tt,{});if(!S)return(0,g.jsx)(B.Z,{});return(0,g.jsxs)(c.Z,{children:[(0,g.jsxs)(o.default,{children:[(0,g.jsx)("title",{children:"whereiam"}),(0,g.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,g.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,g.jsx)("main",{children:k?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(w.Z,{title:d("dashboard.users")}),(0,g.jsxs)(Z.L,{children:[(0,g.jsx)(u.Z,{markers:N,selectedUser:e}),(0,g.jsx)(Z.Q,{children:(0,g.jsx)(j.Z,{users:S,onUserClick:function(t){return n(t)}})})]}),(0,g.jsxs)(f.ZP,{container:!0,spacing:2,sx:{pt:2},children:[(0,g.jsx)(f.ZP,{item:!0,lg:6,md:6,sm:12,xs:12,children:(0,g.jsx)(C,{data:O,title:"Statuses"})}),(0,g.jsx)(f.ZP,{item:!0,lg:6,md:6,sm:12,xs:12,children:(0,g.jsx)(C,{data:I,title:"Cities"})})]})]}):(0,g.jsx)(v,{title:d("dashboard.bannerTitle"),buttonText:d("dashboard.bannerButtonText"),buttonHref:"/user/profile"})}),(0,g.jsx)(it,{})]})}},32442:function(t,e,n){"use strict";n.d(e,{Z:function(){return m}});var r=n(6158),o=n.n(r),i=(n(81634),n(67294)),a=n(55113),c=n(85893),s=function(t){var e=t.mapNode;return(0,c.jsx)(a.Z,{sx:{height:"calc(60vh)"},children:(0,c.jsx)("div",{ref:e,style:{width:"100%",height:"100%"}})})},u=n(1527),l=function(){var t=(0,i.useState)(),e=t[0],n=t[1],r=(0,i.useRef)(null),a=[24.065285,49.8138699];return(0,i.useEffect)((function(){var t=r.current;if(null!==t){var e=new(o().Map)({container:t,accessToken:"pk.eyJ1IjoidHJvbnlhIiwiYSI6ImNpdXNteHUwdzAwMWkyenBmamRlbTk2Zm8ifQ.aFKT4IOHyPCPRt_GNfUYnw",style:"mapbox://styles/tronya/cixa87ptp00g12qo9jjbqm9mk",center:a,zoom:11});n(e)}}),[]),{mapboxMap:e,mapNode:r}},d=n(22320),f=n(66001);function p(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var m=function(t){var e=t.markers,n=t.selectedUser,r=l(),a=r.mapboxMap,c=r.mapNode,h=(0,f.a)();return(0,i.useEffect)((function(){if(a)return a.addControl(new(o().GeolocateControl)({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})),function(){a.remove()}}),[a]),(0,i.useEffect)((function(){n&&a&&a.flyTo({center:[null===n||void 0===n?void 0:n.coords.longitude,null===n||void 0===n?void 0:n.coords.latitude],essential:!0,zoom:14})}),[a,n]),(0,i.useEffect)((function(){var t=navigator.geolocation.watchPosition((function(t){var e;null!==(e=h.user)&&void 0!==e&&e.uid&&(0,d.xf)(h.user.uid,(0,d.wZ)(t,h.user))}));return function(){navigator.geolocation.clearWatch(t)}}),[h.user]),(0,i.useEffect)((function(){if(null!==e&&void 0!==e&&e.length&&a){var t,n=p(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;(0,u.R)(r,a)}}catch(o){n.e(o)}finally{n.f()}}}),[a,e]),(0,i.createElement)(s,{mapNode:c})}},79951:function(t,e,n){"use strict";n.d(e,{L:function(){return i},Q:function(){return a}});var r=n(8797),o=n(87357),i=(0,r.ZP)(o.Z)({position:"relative",backgroundColor:"grey"}),a=(0,r.ZP)(o.Z)({position:"absolute",top:0,padding:"16px 24px",display:"flex",zIndex:9})},33580:function(t,e,n){"use strict";var r=n(1527),o=n(70315);e.Z=function(t){var e=[];return(0,r.c)(t).forEach((function(t){var n=document.createElement("div"),r=t.properties.iconSize[0],i=t.properties.iconSize[1];n.style.borderRadius="50%",n.style.backgroundRepeat="no-repeat",n.style.backgroundImage=t.properties.backgroundImage?"url(".concat(t.properties.backgroundImage,")"):"url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='30px' width='30px'><text x='6' y='20' fill='black' font-size='15'>".concat((0,o.Yd)(t.properties.displayName),'</text></svg>")'),n.style.width="".concat(r,"px"),n.style.height="".concat(i,"px"),n.style.backgroundSize="100%",e.push({popup:n,marker:t})})),e}},1527:function(t,e,n){"use strict";n.d(e,{c:function(){return i},R:function(){return a}});var r=n(6158),o=n.n(r),i=function(t){return t.map((function(t){return{properties:{description:t.displayName,iconSize:[40,40],backgroundImage:t.photoURL,displayName:t.displayName},geometry:{type:"Point",coordinates:[t.coords.longitude,t.coords.latitude]}}}))},a=function(t,e){var n=new(o().Popup)({closeButton:!1,closeOnClick:!1});t.popup.addEventListener("mouseenter",(function(){if(t.popup.style.cursor="pointer",t.marker.properties.description){var r='<p style="color:black;">'.concat(t.marker.properties.description,"</p>");n.setLngLat(t.marker.geometry.coordinates).setHTML(r).addTo(e)}})),t.popup.addEventListener("mouseleave",(function(){t.popup.style.cursor="",n.remove()})),new(o().Marker)(t.popup).setLngLat(t.marker.geometry.coordinates).addTo(e)}},45301:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(35498)}])}},function(t){t.O(0,[885,634,228,463,524,584,913,14,153,774,888,179],(function(){return e=45301,t(t.s=e);var e}));var e=t.O();_N_E=e}]);